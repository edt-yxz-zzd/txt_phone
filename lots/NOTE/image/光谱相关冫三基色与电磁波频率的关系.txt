
e ../lots/NOTE/image/光谱相关冫三基色与电磁波频率的关系.txt

[[
@20251022
https://zhuanlan.zhihu.com/p/599296976
===
知乎

颜色的数学理论II——三基色理论、格拉斯曼定律与颜色空间的数学结构
1 年前 · 来自专栏 色彩科学
缺心眼的香菜
清华大学 工学硕士

关注
颜色的数学理论II——三基色理论、格拉斯曼定律与颜色空间的数学结构
1. 前言
在本系列的第一篇文章（颜色的数学理论I——辐射度量学与光度学基础）中，我们详细介绍了色度学的“序章”——辐射度量学和光度学。辐射度量学和光度学是颜色得以定量化的必备条件，这就是我们花费如此大的篇幅讲述它们的原因。如果你对辐射度量学和光度学还没有基本的概念，那么建议你先阅读第一篇文章。

奠定基础是为了更高的目标，在本文中我们将正式开始学习色度学的内容。

色度学，顾名思义就是对颜色进行度量的一门学科，或者说，对颜色进行定量化描述的一门学科。人们虽然很早就注意到了很多和颜色相关的视觉和光学现象，但真正严格从数学上对颜色进行定量描述却只是近100年的事。现代色度学使得颜色的精确复制和呈现成为可能，是纺织、印刷、摄影、照明、颜料制造、电视、电影和显示设备制造等工业领域的基石。

本文从牛顿的色散实验出发，介绍三基色理论和色光混合（相加）的实验定律，由此初步确定颜色空间的数学结构。

2. 三基色理论与颜色匹配实验
2.1. 牛顿色散实验
1666年，康熙皇帝即位的第五年，远在大洋彼岸的英国，一个名叫牛顿的23岁青年正在老家——林肯郡的伍尔索普村——躲避瘟疫。他利用一块从附近集市上买来的三棱镜，成功将一束太阳光分解成了五彩斑斓的光带。牛顿将光带中的色光按照折射角度的大小划分为红（red）、橙（orange）、黄（yellow）、绿（green）、蓝（blue）、靛（indigo）、紫（violet）七个部分。进一步，牛顿让光带中每一种颜色的光分别通过遮光板上的小孔，在小孔后他使用另一个三棱镜试图对通过的单色光再进行分解，结果却是：通过小孔的单色光无法再被分解。牛顿由此得出猜想：白光不是一种纯色光，而是由各种不同的（无法再被分解的）单色光混合而成的。


图1. 白光的色散
为了验证这一想法，牛顿又设计了一种装置（图2），利用凸透镜将分解出的七色光重新混合，结果是又得到了白色光。至此，牛顿通过一系列实验，证明了太阳光（白光）并不是一种纯色光，而是由不同种类的单色光混合而成的。


图2. 牛顿的单色光混合实验装置图
在色散实验的基础上，牛顿绘制了人类历史上的第一个色环（图3），他指出：通过混合色环中的红色和紫色光可以得到新的颜色，例如品红色（magenta）和紫红色（purple），而品红色和紫红色不存在于三棱镜实验的光带中。也就是说，紫红色和品红色不对应可见光谱中的任何一种颜色。

牛顿凭借这一系列出色的研究成果，成功跻身色彩科学研究先驱的行列。

这里特别提醒读者注意，本文中讨论的颜色混合规律都是针对色光（colored light）的，而不是颜料的，颜料的混合规律和色光的混合规律并不相同。这主要是因为颜料的颜色是它吸收白光中某些波长的光，而反射另一些波长的光所产生的。也就是说，颜料的颜色体现的是颜料对于不同波长光的吸收特性。


图3. 牛顿的色环
2.2. 三基色理论
牛顿色散实验之后，色彩科学中最重要的成果就是三基色理论。法国物理学家马略特（Mariotte）可能是最早提出三基色理论的人，他认为：只要按照适当比例混合三种颜色的光就足以制造出所有人眼可见的色光。相应地，这三种用来生成其他颜色的色光就被称为三基色光，简称三基色。托马斯 · 杨和亥姆霍兹对马略特的思想进行了细化和完善，形成了杨-亥姆霍兹理论。杨-亥姆霍兹理论进一步认为，之所以存在三基色，是因为人眼的视网膜上有三种类型的感光细胞，它们分别对红、绿、蓝光敏感。现代生理学证实了这种观点，如今我们称这三种视锥细胞为L-视锥细胞、M-视锥细胞和S-视锥细胞，它们分别对长波、中波和短波敏感。

图5展示的是三种视锥细胞对于不同波长光的敏感程度。三种视锥细胞受刺激的组合状态就对应着特定的颜色。举例来说，当仅有L-视锥细胞和M-视锥细胞受刺激时，人眼感受到的就是红光和绿光混合的颜色。根据这两种视锥细胞受刺激的相对比例不同，人脑可产生到从红渐变到绿的一系列颜色（包含红、橙、黄、绿等）印象。

根据三基色理论，人眼在数学上进行的是一种类似于“投影”的操作，对于一个连续光信号（它是无穷维函数空间中的），人眼将其投影到三种视锥细胞三刺激值形成的三维空间中。并且，根据实验结果可以知道，这种“投影”操作在数学上具有线性性质。


图4. 人眼的生理构造

图5. 三种视锥细胞对于不同波长光的敏感程度
在三基色理论的基础上，麦克斯韦提出了著名的颜色三角形。如图6所示，麦克斯韦将三基色分别放在等边三角形的三个顶点上，由这三基色混合产生的所有颜色都在三角形的内部。其中，内部任意一点到三边的距离表示了三种基色混合时的相对比例，而三角形的中心则表示白点。麦克斯韦三角形在后世出现了很多变体，如今已经难以考证麦克斯韦本人最初对颜色三角形用法的约定了。1861年，利用三基色理论，麦克斯韦生成了世界上第一张彩色照片——一条蓝紫色的领结。

麦克斯韦的一系列研究奠定了色度学中定量化方法的基础。


图6. 麦克斯韦的颜色三角形
2.3. 颜色匹配实验
在三基色理论的基础上，人们开始研究利用特定三基色表示其他颜色的具体方法。由于任何一种色光总可以看作是由不同波长的单色光按照一定比例混合而成的（回忆一下我们在第一篇文章里提到过的傅里叶分析的基本思想）。因而，为了证明三种基色能够混合产生所有的颜色，只需要证明三种基色能够混合产生所有的单色光即可。更进一步，剔除那些人眼不可见的单色光，我们只需要证明三种基色能够混合产生所有人眼可见的单色光即可。

图7展示的是颜色匹配实验的示意图，一块光屏被隔板分割成左右两个区域，右侧被单色光照亮的区域为参考域（reference field），左侧被三基色混合色光照亮的区域为匹配域（matched field）。整个被照亮的区域在光屏上的面积很小，小到这个区域相对观察者的视角仅为2°，这能保证此区域投射的光线大致落在观察者视网膜的中央凹（即“fovea”，见图4）附近。之所以要这样做，是因为中央凹附近遍布着密集的视锥细胞，而缺乏视杆细胞，控制视角的大小可以有效地保证实验过程中只有视锥细胞参与。但这种实验条件并不能反映人眼感知颜色的真实情形：在绝大多数场景中，人眼都是在亮光环境下感知颜色的，此时视锥细胞和视杆细胞都会参与。关于这一点，我们后续后还会进行详细的讨论。

实验时，先设定右侧单色光源的波长为 \lambda ，同时调节光源功率使得参考域的辐亮度为 L_\mathrm{Ref} 。接着不断调节左侧三基色光源的辐亮度，直至匹配域的颜色看起来和参考域的完全一致，记录下此时左侧三基色光源的相对辐亮度 \bar{r}\left(\lambda\right) 、 \bar{g}\left(\lambda\right) 和 \bar{b}\left(\lambda\right) （它们的具体定义我们后面会给出）。这样就完成了一次色光混合颜色匹配实验。对不同的 \lambda 不断重复上述实验过程，就可以得到 \bar{r}\left(\lambda\right) 、 \bar{g}\left(\lambda\right) 和 \bar{b}\left(\lambda\right) 的函数图像。我们称 \bar{r}\left(\lambda\right) 、 \bar{g}\left(\lambda\right) 和 \bar{b}\left(\lambda\right)为颜色匹配函数（color-matching functions）。


图7. 色光混合颜色匹配实验示意图
1928年，帝国理工学院（Imperial College London）的Wright以650nm的红光、530nm的绿光和460nm的蓝光作为三基色进行了颜色匹配实验；紧接着，英国国家物理实验室（National Physical Laboratory，NPL）的Guild以630nm的红光、540nm的绿光和460nm的蓝光作为三基色再次进行了颜色匹配实验。由于Wright和Guild所采用的三基色不统一，实验数据无法直接对比，这给色度学研究带来了一定的不便。鉴于此，1931年9月18日上午9:30（注意这个时间），CIE在剑桥大学三一学院召开会议，提议以700nm的红光、546.1nm的绿光和435.8nm的蓝光作为三基色，并导出了由Wright和Guild的数据给出的颜色匹配函数，结果如图8所示。


图8. CIE 1931颜色匹配函数
细心的读者可能会对图8产生一些疑问：为什么 \bar{r}\left(\lambda\right) 会在一些波段出现负值？毕竟，没有哪个光源能够发出亮度为负值的光，不是吗？实际上，这是因为：当参考域中的单色光处在此波段时，无论怎样降低左侧红色光源的亮度，都无法实现左右两侧颜色的匹配，为了完成匹配，必须将一定亮度的红色光加到右侧的参考域中。这种情况下就相当于匹配域中需要“减去”一定亮度的红色光才能匹配目标单色光，于是就将这时的 \bar{r}\left(\lambda\right) 规定为负值。

至此，CIE 1931色度系统已经近在咫尺了。但是为了更好地理解颜色空间的结构，方便后续从数学上对其进行描述，我们必须先回顾一下色度学中的各种实验定律。

3. 格拉斯曼定律
在大量色光混合实验的基础上，格拉斯曼于1854年总结出了色光混合的格拉斯曼定律。格拉斯曼定律是整个色度学中最核心的内容，它在色度学中的地位大致相当于牛顿三定律在力学中的地位。

格拉斯曼定律的内容如下：

（a）人眼能且仅能感知颜色的三种特征，即：色相（hue）、饱和度（saturation）和亮度（luminance）。

（b）两种色光，若它们对人眼的色觉刺激相同，则它们在色光混合实验中的表现就完全相同，无论这两种色光的光谱组成如何。

（c）无论两种色光的功率谱如何，只要它们具有相同的色相和饱和度，混合时就会产生另一种具有相同色相和饱和度的色光。

（d）混合色光的亮度等于各组分色光的亮度之和。

其中，定律（d）又被称为Abney定律。格拉斯曼定律在不同文献中的表述差异较大，例如，有些文献中定律（c）被替换为：

（c'）两种色光混合时，若其中一种成分发生变化，则混合色的特征也相应地改变。且混合色的特征连续地依赖于组分色的特征。

本文采取（c）的说法，因为它更直接地指向颜色空间的线性结构。接下来，本文将利用严密的数学记号对定律重新进行表述，并给出推论的导出过程。

首先，为了简单起见，我们将使用 \left[ \mathrm{C} \right] 来表示色光 \mathrm{C} 对人眼的刺激（即色光 \mathrm{C} 的颜色），那么格拉斯曼定律（a）说明：描述 \left[ \mathrm{C} \right] 需要且仅需要三个参数。描述 \left[ \mathrm{C} \right] 的最后一个参数——即亮度——我们已经在光度学部分将其严格化了，后续只需要研究如何定义另外两个参数即可。这里请读者注意，色光 \mathrm{C} 本身的特征并不只有颜色这一项，它还有功率谱等物理学上的特征。

若色光 \mathrm{C}_1 和 \mathrm{C}_2 在人眼看来是相同的，我们就说 \mathrm{C}_1 匹配（match） \mathrm{C}_2 ，记作：

\mathrm{C}_1 \sim \mathrm{C}_2 \tag{1} 对数学比较熟悉的读者可能已经发现了，这样定义的“ \sim ”是一个等价关系。因为有：

（i）自反性：对于任意 \mathrm{C} 都有 \mathrm{C} \sim \mathrm{C}；

（ii）对称性：若 \mathrm{C}_1 \sim \mathrm{C}_2 ，则 \mathrm{C}_2 \sim \mathrm{C}_1 ；

（iii）传递性：若 \mathrm{C}_1 \sim \mathrm{C}_2 且 \mathrm{C}_2 \sim \mathrm{C}_3 ，则 \mathrm{C}_1 \sim \mathrm{C}_3 。

假如我们将所有色光构成的集合记为 \mathscr{L} ，将所有颜色构成的集合记为 \mathscr{C} ，那么 \mathscr{C} 可以看作是 \mathscr{L} 关于等价关系 \sim 的商集，即：

\mathscr{C}=\mathscr{L}/\sim \tag{2} 在这个观点下， \left[ \mathrm{C} \right] 恰好可以看作是色光 \mathrm{C} 关于 \sim 的等价类。

进一步，我们记色光 \mathrm{C}_1 和 \mathrm{C}_2 混合得到的色光为“ \mathrm{C}_1 \oplus \mathrm{C}_2 ”，那么 \mathrm{C}_1 \oplus \mathrm{C}_2 的颜色为 \left[ \mathrm{C}_1 \oplus \mathrm{C}_2 \right] ，我们不妨定义“颜色的加法运算”为：

\left[ \mathrm{C}_1 \right] + \left[ \mathrm{C}_2 \right] \triangleq \left[ \mathrm{C}_1 \oplus \mathrm{C}_2 \right] \tag{3}

格拉斯曼定律告诉我们，这个定义是适定的。这时因为：假如 \left[\mathrm{C}_1\right]=\left[\mathrm{C}_3\right] ， \left[\mathrm{C}_2\right]=\left[\mathrm{C}_4\right] ，那么定律（b）告诉我们： \left[ \mathrm{C}_1 \oplus \mathrm{C}_2 \right]=\left[ \mathrm{C}_3 \oplus \mathrm{C}_4 \right] \tag{4} 即：

\left[ \mathrm{C}_1 \right] + \left[ \mathrm{C}_2 \right]=\left[ \mathrm{C}_3 \right] + \left[ \mathrm{C}_4 \right] \tag{5} 另一方面，根据物理学知识，运算“ \oplus ”显然具有结合律，那么我们可以发现：

\left( \left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2 \right] \right) +\left[ \mathrm{C}_3 \right] =\left[ \mathrm{C}_1\oplus \mathrm{C}_2 \right] +\left[ \mathrm{C}_3 \right] =\left[ \left( \mathrm{C}_1\oplus \mathrm{C}_2 \right) \oplus \mathrm{C}_3 \right] =\left[ \mathrm{C}_1\oplus \left( \mathrm{C}_2\oplus \mathrm{C}_3 \right) \right] \\ =\left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2\oplus \mathrm{C}_3 \right] =\left[ \mathrm{C}_1 \right] +\left( \left[ \mathrm{C}_2 \right] +\left[ \mathrm{C}_3 \right] \right) \tag{6}

这说明运算“ + ”满足结合律。

对于色光 \mathrm{C} ，若其功率谱为 P\left(\lambda\right) ，那么我们定义 \alpha\mathrm{C} （ \alpha \in \mathbb{R}, \alpha\ge 0 ）为：将 \mathrm{C} 的功率谱变为 \alpha P\left(\lambda\right) 而不改变 \mathrm{C} 的其他特征（例如偏振）所得到的色光。物理上，可以通过将 \mathrm{C} 中的电磁场放大（缩小） \sqrt{\alpha} 倍得到 \alpha\mathrm{C} 。由于 \alpha\mathrm{C} 的各组分色光相对比例并不发生变化，只是辐亮度变为了 \mathrm{C} 的 \alpha 倍，所以它应该和 \mathrm{C} 具有相同的色相与饱和度。而根据光度学的知识， \alpha\mathrm{C} 的亮度恰好是 \mathrm{C} 的 \alpha 倍。这启发我们定义“颜色的数乘运算”：

\alpha \left[ \mathrm{C} \right] \triangleq \left[ \alpha \mathrm{C} \right],\alpha \ge 0. \tag{7} 这样定义的数乘运算也是适定的，读者可以利用格拉斯曼定律自行验证。由于电磁场满足线性叠加特性，我们立刻可以发现：

\alpha \left( \left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2 \right] \right) =\alpha \left[ \mathrm{C}_1\oplus \mathrm{C}_2 \right] =\left[ \alpha \left( \mathrm{C}_1\oplus \mathrm{C}_2 \right) \right] =\left[ \alpha \mathrm{C}_1\oplus \alpha \mathrm{C}_2 \right] \\ =\left[ \alpha \mathrm{C}_1 \right] +\left[ \alpha \mathrm{C}_2 \right] =\alpha \left[ \mathrm{C}_1 \right] +\alpha \left[ \mathrm{C}_2 \right] \tag{8} \left( \alpha +\beta \right) \left[ \mathrm{C} \right] =\left[ \left( \alpha +\beta \right) \mathrm{C} \right] =\left[ \alpha \mathrm{C}\oplus \beta \mathrm{C} \right] =\left[ \alpha \mathrm{C} \right] +\left[ \beta \mathrm{C} \right] =\alpha \left[ \mathrm{C} \right] +\beta \left[ \mathrm{C} \right] \tag{9} 这里 \beta \in \mathbb{R}, \beta\ge 0 。

最后，若我们定义 \left[ \mathrm{C} \right] 的亮度为 L_{\mathrm{V}}\left( \left[ \mathrm{C} \right] \right) ，那么Abney定律定律告诉我们：

L_{\mathrm{V}}\left( \left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2 \right] \right) =L_{\mathrm{V}}\left( \left[ \mathrm{C}_1 \right] \right) +L_{\mathrm{V}}\left( \left[ \mathrm{C}_2 \right] \right) \tag{10} 即映射 L_{\mathrm{V}} 对于运算“ + ”具有线性相加性。

以上这些结果强烈地暗示着我们： \mathscr{C} 可能是 \mathbb{R} 上的线性空间。然而一个棘手的问题是，上述颜色的数乘运算（7）对于 \alpha\lt 0 的情况似乎没有意义，毕竟没有人能够制造出“负的颜色”。而要使\mathscr{C} 成为 \mathbb{R} 上的线性空间，我们必须对负实数 \alpha 也定义颜色的数乘运算。

那么我们要如何解决这个问题呢？答案是：利用色光混合颜色匹配实验里的思路。在2.3节的图8中，我们遇到过三基色光源中红色光源亮度为负值的情况，在那里我们的解释是：负的亮度代表需要把红光加到参考域中。在这里我们可以采取完全一样的思路，例如，对于一种物理上可实现的 \left[\mathrm{C}\right] ，我们把 \left(-\alpha\right)\left[\mathrm{C}\right]\left(\alpha\in\mathbb{R},\alpha\ge0\right) 理解为从匹配域的混合色光中去掉 \alpha\left[\mathrm{C}\right] （如果可行的话），或是在参考域的色光中加入 \alpha\left[\mathrm{C}\right] 。在这样的定义下，我们可以扩充\mathscr{C} ，把所有的 \left(-\alpha\right)\left[\mathrm{C}\right]\left(\alpha\in\mathbb{R},\alpha\ge0\right) 也加入其中。

经过扩充，\mathscr{C} 将成为 \mathbb{R} 上的线性空间， L_\mathrm{V}:\mathscr{C}\rightarrow\mathbb{R} 将成为线性算子。但是需要注意的是，经过扩充的 \mathscr{C} 包含了非物理的“颜色”。它们不仅不可见，甚至不可能在现实世界中被制造出来，因而只具有数学上的意义。

接下来我们来总结一下已经得到的结果。

4. 颜色空间的线性结构
在上一节的定义下，\mathscr{C} 是 \mathbb{R} 上的线性空间。我们现在来逐一检查线性空间的各项公理。

（1）加法交换律

\left[ \mathrm{C}_1 \right] + \left[ \mathrm{C}_2 \right] = \left[ \mathrm{C}_2 \right] + \left[ \mathrm{C}_1 \right],\forall \left[ \mathrm{C}_1 \right] , \left[ \mathrm{C}_2 \right] \in \mathscr{C} . \tag{11} （2）加法结合律

\left( \left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2 \right] \right) +\left[ \mathrm{C}_3 \right] =\left[ \mathrm{C}_1 \right] +\left( \left[ \mathrm{C}_2 \right] +\left[ \mathrm{C}_3 \right] \right), \forall \left[ \mathrm{C}_1 \right] , \left[ \mathrm{C}_2 \right], \left[ \mathrm{C}_3 \right] \in \mathscr{C} .\tag{12} （3）存在加法零元

加法的零元对应的就是色光为零（光源关闭）的情况，我们记加法零元为 \left[0\right] ，则：

\left[ \mathrm{C} \right] + \left[ 0 \right] = \left[ \mathrm{C} \right] ,\forall \left[ \mathrm{C} \right] \in \mathscr{C} . \tag{13} （4）存在加法逆元

对于任意 \left[ \mathrm{C} \right] \in \mathscr{C} ，我们总可以构造 \left(-1\right)\left[ \mathrm{C} \right]=-\left[ \mathrm{C} \right] 为它的加法逆元。

（5）存在乘法单位元

1\left[\mathrm{C}\right]=\left[\mathrm{C}\right], \forall \left[\mathrm{C}\right]\in \mathscr{C}. \tag{14} （6）数乘的分配律

\alpha \left( \left[ \mathrm{C}_1 \right] +\left[ \mathrm{C}_2 \right] \right) =\alpha \left[ \mathrm{C}_1 \right] +\alpha \left[ \mathrm{C}_2 \right], \forall \left[ \mathrm{C}_1 \right],\left[ \mathrm{C}_2 \right] \in \mathscr{C}, \forall \alpha \in \mathbb{R}. \tag{15} \left( \alpha +\beta \right) \left[ \mathrm{C} \right] =\alpha \left[ \mathrm{C} \right] +\beta \left[ \mathrm{C} \right],\forall \left[ \mathrm{C} \right] \in \mathscr{C}, \forall \alpha, \beta \in \mathbb{R}. \tag{16} 至此，我们就确立了 \left(\mathscr{C},\mathbb{R}\right) 作为线性空间的结构。那么线性空间 \left(\mathscr{C},\mathbb{R}\right) 的维数是多少呢？三基色理论告诉我们答案是3。

5. 结语
本文从颜色科学的实验定律出发，确立了颜色空间的基本数学结构，使得利用线性代数方法研究颜色理论成为可能。

从格拉斯曼定律通往颜色空间数学结构的具体途径鲜见于现有的文献，因此在撰写本文的过程中作者加入了很多原创性的想法，若有谬误，还请方家不吝赐教。

参考文献
[1] Malacara A D. Color Vision and Colorimetry: Theory and Applications, Second Edition[M]. 2011.

[2] Fairman H S, Brill M H, Hemmendinger H. How the CIE 1931 color‐matching functions were derived from Wright‐Guild data[J]. Color Research & Application, 1997, 22(1):11-23.

[3] The First Book of Opticks. Part II (1704)

[4] CIE (1931) color space

编辑于 2024-01-26 10:27・上海
]]
