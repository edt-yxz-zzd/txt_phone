#__all__:goto
r'''[[[
e script/枚举冫加一偶幂型素数.py
view script/枚举冫双幂方和型素数.py

script.枚举冫加一偶幂型素数
py -m nn_ns.app.debug_cmd   script.枚举冫加一偶幂型素数 -x # -off_defs
py -m nn_ns.app.doctest_cmd script.枚举冫加一偶幂型素数:__doc__ -ht # -ff -df

[[
outputs:
view /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt
    3.9M
view /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt
    244K
view script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma
    72K
    tar -xf script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma -O | more
    py_adhoc_call  script.枚举冫加一偶幂型素数   ,注水解包冫输出文件扌  --path:script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma  +whether_tar_lzma  | more
]]

[[
py_adhoc_call { +lineno }  script.枚举冫加一偶幂型素数   ,枚举冫加一偶幂型素数扌  --ez=2  --may_end4half_base=1024 +using_tabulate4factorization
py_adhoc_call { +lineno }  script.枚举冫加一偶幂型素数   ,枚举冫加一偶幂型素数扌  --ez=2  --may_end4half_base=1024
    207行:
===
1:(4, 2, 17)
2:(4, 4, 257)
3:(4, 6, 1297)
4:(4, 16, 65537)
5:(4, 20, 160001)
6:(4, 24, 331777)
7:(4, 28, 614657)
8:(4, 34, 1336337)
9:(4, 46, 4477457)
10:(4, 48, 5308417)
11:(4, 54, 8503057)
12:(4, 56, 9834497)
13:(4, 74, 29986577)
14:(4, 80, 40960001)
15:(4, 82, 45212177)
16:(4, 88, 59969537)
17:(4, 90, 65610001)
18:(4, 106, 126247697)
19:(4, 118, 193877777)
20:(4, 132, 303595777)
21:(4, 140, 384160001)
22:(4, 142, 406586897)
23:(4, 154, 562448657)
24:(4, 160, 655360001)
25:(4, 164, 723394817)
26:(4, 174, 916636177)
27:(4, 180, 1049760001)
28:(4, 194, 1416468497)
29:(4, 198, 1536953617)
30:(4, 204, 1731891457)
31:(4, 210, 1944810001)
32:(4, 220, 2342560001)
33:(4, 228, 2702336257)
34:(4, 238, 3208542737)
35:(4, 242, 3429742097)
36:(4, 248, 3782742017)
37:(4, 254, 4162314257)
38:(4, 266, 5006411537)
39:(4, 272, 5473632257)
40:(4, 276, 5802782977)
41:(4, 278, 5972816657)
42:(4, 288, 6879707137)
43:(4, 296, 7676563457)
44:(4, 312, 9475854337)
45:(4, 320, 10485760001)
46:(4, 328, 11574317057)
47:(4, 334, 12444741137)
48:(4, 340, 13363360001)
49:(4, 352, 15352201217)
50:(4, 364, 17555190017)
51:(4, 374, 19565295377)
52:(4, 414, 29376588817)
53:(4, 430, 34188010001)
54:(4, 436, 36136489217)
55:(4, 442, 38167092497)
56:(4, 466, 47156728337)
57:(4, 472, 49632710657)
58:(4, 476, 51336683777)
59:(4, 488, 56712564737)
60:(4, 492, 58594980097)
61:(4, 494, 59553569297)
62:(4, 498, 61505984017)
63:(4, 504, 64524128257)
64:(4, 516, 70892257537)
65:(4, 526, 76549608977)
66:(4, 540, 85030560001)
67:(4, 550, 91506250001)
68:(4, 554, 94197431057)
69:(4, 556, 95565066497)
70:(4, 566, 102627966737)
71:(4, 568, 104086245377)
72:(4, 582, 114733948177)
73:(4, 584, 116319195137)
74:(4, 600, 129600000001)
75:(4, 616, 143986855937)
76:(4, 624, 151613669377)
77:(4, 628, 155538739457)
78:(4, 656, 185189072897)
79:(4, 690, 226671210001)
80:(4, 702, 242855782417)
81:(4, 710, 254116810001)
82:(4, 730, 283982410001)
83:(4, 732, 287107358977)
84:(4, 738, 296637086737)
85:(4, 742, 303120718097)
86:(4, 748, 313044726017)
87:(4, 758, 330123790097)
88:(4, 760, 333621760001)
89:(4, 768, 347892350977)
90:(4, 772, 355196928257)
91:(4, 778, 366368720657)
92:(4, 786, 381671897617)
93:(4, 788, 385571451137)
94:(4, 798, 405519334417)
95:(4, 800, 409600000001)
96:(4, 810, 430467210001)
97:(4, 856, 536902045697)
98:(4, 874, 583506543377)
99:(4, 894, 638778183697)
100:(4, 912, 691798081537)
101:(4, 914, 697886476817)
102:(4, 928, 741637881857)
103:(4, 930, 748052010001)
104:(4, 936, 767544201217)
105:(4, 952, 821386940417)
106:(4, 962, 856446597137)
107:(4, 966, 870780120337)
108:(4, 986, 945165062417)
109:(4, 992, 968381956097)
110:(4, 996, 984095744257)
111:(4, 1038, 1160885573137)
112:(4, 1042, 1178883463697)
113:(4, 1072, 1320623865857)
114:(4, 1076, 1340445266177)
115:(4, 1088, 1401249857537)
116:(4, 1126, 1607509551377)
117:(4, 1132, 1642047467777)
118:(4, 1136, 1665379926017)
119:(4, 1142, 1700843738897)
120:(4, 1144, 1712789917697)
121:(4, 1150, 1749006250001)
122:(4, 1152, 1761205026817)
123:(4, 1170, 1873887210001)
124:(4, 1180, 1938777760001)
125:(4, 1200, 2073600000001)
126:(4, 1202, 2087458598417)
127:(4, 1218, 2200843458577)
128:(4, 1236, 2333855068417)
129:(4, 1238, 2348997630737)
130:(4, 1246, 2410305930257)
131:(4, 1252, 2457068790017)
132:(4, 1270, 2601446410001)
133:(4, 1280, 2684354560001)
134:(4, 1302, 2873716601617)
135:(4, 1322, 3054399363857)
136:(4, 1330, 3129007210001)
137:(4, 1344, 3262849744897)
138:(4, 1382, 3647809685777)
139:(4, 1388, 3711571783937)
140:(4, 1404, 3885692518657)
141:(4, 1406, 3907880570897)
142:(4, 1428, 4158271385857)
143:(4, 1434, 4228599998737)
144:(4, 1442, 4323754644497)
145:(4, 1446, 4371929719057)
146:(4, 1458, 4518872583697)
147:(4, 1472, 4694952902657)
148:(4, 1486, 4876129574417)
149:(4, 1496, 5008715616257)
150:(4, 1536, 5566277615617)
151:(4, 1540, 5624486560001)
152:(4, 1542, 5653761639697)
153:(4, 1552, 5801854959617)
154:(4, 1554, 5831819287057)
155:(4, 1558, 5892095988497)
156:(4, 1568, 6044831973377)
157:(4, 1586, 6327217036817)
158:(4, 1594, 6455847578897)
159:(4, 1598, 6520893388817)
160:(4, 1610, 6718982410001)
161:(4, 1612, 6752430919937)
162:(4, 1618, 6853526069777)
163:(4, 1622, 6921550621457)
164:(4, 1638, 7198725105937)
165:(4, 1644, 7304781885697)
166:(4, 1646, 7340393187857)
167:(4, 1650, 7412006250001)
168:(4, 1652, 7448008642817)
169:(4, 1666, 7703711109137)
170:(4, 1680, 7965941760001)
171:(4, 1688, 8118761230337)
172:(4, 1700, 8352100000001)
173:(4, 1706, 8470637710097)
174:(4, 1710, 8550360810001)
175:(4, 1718, 8711493922577)
176:(4, 1722, 8792909200657)
177:(4, 1738, 9124290174737)
178:(4, 1754, 9464950698257)
179:(4, 1772, 9859499520257)
180:(4, 1788, 10220450939137)
181:(4, 1806, 10638269396497)
182:(4, 1820, 10971993760001)
183:(4, 1824, 11068769304577)
184:(4, 1836, 11362939842817)
185:(4, 1850, 11713506250001)
186:(4, 1854, 11815141283857)
187:(4, 1864, 12072122454017)
188:(4, 1870, 12228309610001)
189:(4, 1892, 12813994352897)
190:(4, 1910, 13308633610001)
191:(4, 1916, 13476652155137)
192:(4, 1926, 13760212194577)
193:(4, 1932, 13932481925377)
194:(4, 1934, 13990263006737)
195:(4, 1942, 14223186420497)
196:(4, 1944, 14281868906497)
197:(4, 1948, 14399778447617)
198:(4, 1952, 14518416572417)
199:(4, 1956, 14637786276097)
200:(4, 1962, 14818219109137)
201:(4, 1972, 15122640998657)
202:(4, 1978, 15307531050257)
203:(4, 1986, 15556682086417)
204:(4, 1994, 15808862273297)
205:(4, 2040, 17318914560001)
206:(4, 2044, 17455149220097)
207:(4, 2046, 17523567165457)
===
]]
[[
py_adhoc_call  script.枚举冫加一偶幂型素数   ,枚举冫加一偶幂型素数扌  --ez=2  --may_end4half_base='2**20' > /sdcard/0my_files/tmp/0tmp
du -h /sdcard/0my_files/tmp/0tmp
    2.5M
    中断于69131行
view /sdcard/0my_files/tmp/0tmp
===
(4, 2, 17) # 1
... ...
(4, 1349534, 3316922485054455798328337) # 69131
seed.math.prime_gens.OverflowError__Miller_Rabin_primality_test__A014233: [3317044064679887385962123 == upperbound <= n == 3317433742832116478988817]
===
>>> 1+(1349534)**4
3316922485054455798328337
>>> 1+(1349534+2*26)**4
3317433742832116478988817
>>> (1349534+2*26) == 1349586
True
>>> 1+(1349586)**4
3317433742832116478988817
>>> (1349534//2).bit_length()
20
>>> bin(1349534//2)
'0b10100100101111001111'


]]
[[
py_adhoc_call  script.枚举冫加一偶幂型素数   ,枚举冫加一偶幂型素数扌  --ez=2  --may_end4half_base='2**20' +using_tabulate4factorization > /sdcard/0my_files/tmp/1tmp
du -h /sdcard/0my_files/tmp/1tmp
    3.9M
view /sdcard/0my_files/tmp/1tmp
===
(4, 2, 17) # 1
... ...
(4, 1349534, 3316922485054455798328337) # 69131
(4, 1349586, 3317433742832116478988817) # 69132
... ...
(4, 2097142, 19342444181591412122330897) # 103944

===
>>> 2**20 # end4half_base
1048576
>>> 2**21 # end4base
2097152
>>> 2**21/103944
20.17578696221042

===
mv -iv /sdcard/0my_files/tmp/1tmp /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt
du -h /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt
    3.9M
view /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt
tar -cvf script/枚举冫加一偶幂型素数.py..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma --lzma -C  /sdcard/0my_files/tmp/out4py/   script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt
tar -xf script/枚举冫加一偶幂型素数.py..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma -O | more
du -h script/枚举冫加一偶幂型素数.py..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma
    1.1M
rm -iv script/枚举冫加一偶幂型素数.py..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma
]]
[[
py_adhoc_call  script.枚举冫加一偶幂型素数   ,缩水打包冫输出文件扌  --path:/sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt  >  /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt
du -h /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt
    244K
view /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt
===
py_adhoc_call  script.枚举冫加一偶幂型素数   ,注水解包冫输出文件扌  --path:/sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt  | more
py_adhoc_call  script.枚举冫加一偶幂型素数   ,注水解包冫输出文件扌  --path:/sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt  >  /sdcard/0my_files/tmp/2tmp
diff -s /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt /sdcard/0my_files/tmp/2tmp
    identical
===
tar -cvf script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma --lzma -C  /sdcard/0my_files/tmp/out4py/   script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt
tar -xf script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma -O | more
du -h script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma
    72K
===
py_adhoc_call  script.枚举冫加一偶幂型素数   ,注水解包冫输出文件扌  --path:script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma  +whether_tar_lzma  | more
py_adhoc_call  script.枚举冫加一偶幂型素数   ,注水解包冫输出文件扌  --path:script/枚举冫加一偶幂型素数.py.._compact_..exp_eq_4.base_lt_2pow21.out.txt.tar.lzma  +whether_tar_lzma   >  /sdcard/0my_files/tmp/2tmp
diff -s /sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt /sdcard/0my_files/tmp/2tmp
    identical
===
]]

]]]'''#'''
__all__ = r'''
枚举冫加一偶幂型素数扌
缩水打包冫输出文件扌
注水解包冫输出文件扌
'''.split()#'''
__all__
___begin_mark_of_excluded_global_names__0___ = ...
from seed.tiny_.check import check_type_is, check_int_ge
#.from itertools import islice
#.
#.from seed.abc.abc__ver1 import abstractmethod, override, ABC
#.from seed.helper.repr_input import repr_helper
___end_mark_of_excluded_global_names__0___ = ...

#.class __(ABC):
#.    __slots__ = ()
#.    ___no_slots_ok___ = True
#.    def __repr__(sf, /):
#.        return repr_helper(sf, *args, **kwargs)
#.if __name__ == "__main__":
#.    raise NotImplementedError

def 枚举冫加一偶幂型素数扌(ez, begin4half_base=1, may_end4half_base=None, using_tabulate4factorization=False):
    'ez/int{>=1} -> (Iter (exp, base, p){[exp:=2**ez][half_base:<-[begin4half_base..<end4half_base]][base:=2*half_base][p:=(1+base**exp)][is_prime_(p)]})'
    check_int_ge(1, ez)
    check_int_ge(1, begin4half_base)
    if not may_end4half_base is None:
        end4half_base = may_end4half_base
        check_int_ge(1, end4half_base)

    ######################
    from seed.iters.count_ import count_
    ######################
    from seed.math.prime_gens import prime_gen
    lazy_prime_seq = prime_gen.get_or_mk_lazy_prime_seq_()
        # hold weakref
    from seed.math.prime_gens import hold_all_weakrefs4caches_
    __ws = hold_all_weakrefs4caches_()

    ######################
    if not using_tabulate4factorization:
        from seed.math.prime_gens import is_prime__le_pow2_81_
        def is_prime_ex_(exp, base, n, /):
            return is_prime__le_pow2_81_(n)
        is_prime_ex_
    else:
        from seed.math.prime_gens import tabulate_may_factorization4uint_lt_
        from seed.math.is_prime__via_complete_factorization_Nmm_ import is_prime__via_complete_factorization_Nmm_
        if may_end4half_base is None:raise TypeError
        end4half_base
        #bug:base2p2e = tabulate_may_factorization4uint_lt_(end4half_base)
        base2p2e = tabulate_may_factorization4uint_lt_(2*end4half_base)
        assert base2p2e[0] is None
        def is_prime_ex_(exp, base, n, /):
            assert base > 0
                # !! [base2p2e[0] is None]
            p2e4base = base2p2e[base]
            p2e4Nmm = {p:e*exp for p,e in p2e4base.items()}
            return is_prime__via_complete_factorization_Nmm_(p2e4Nmm, n)
        is_prime_ex_
    is_prime_ex_
    ######################
    exp = 1<<ez
    assert exp >= 2
    for half_base in count_(begin4half_base, may_end4half_base):
        base = half_base << 1
        n = 1 + pow(base, exp)
        if not is_prime_ex_(exp, base, n):
            continue
        p = n
        yield (exp, base, p)

def 缩水打包冫输出文件扌(path='/sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数..exp_eq_4.base_lt_2pow21.out.txt'):
    from seed.io.iter_lines5cased_text_ import iter_eval_lines5cased_text__slice_by_marker_lines_, iter_slice_lines5cased_text__by_marker_lines_
    #def iter_eval_lines5cased_text__slice_by_marker_lines_(cased_text, may_line_prefix4begin_marker, may_line_prefix4end_marker, /, *, may_eval_or_name='literal_eval', may_filter_lines4eval_=filter_lines4eval_):
    cased_text = ('path', path, 'utf8')
    iter_records = iter_eval_lines5cased_text__slice_by_marker_lines_(cased_text, None, None)
    iter_compact_records = _compact_(iter_records)
    return iter_compact_records
def 注水解包冫输出文件扌(path='/sdcard/0my_files/tmp/out4py/script.枚举冫加一偶幂型素数.._compact_..exp_eq_4.base_lt_2pow21.out.txt', whether_tar_lzma=False):
    from seed.io.iter_lines5cased_text_ import iter_eval_lines5cased_text__slice_by_marker_lines_
    case = 'path' if not whether_tar_lzma else 'tar_lzma_path'
    cased_text = (case, path, 'utf8')
    iter_compact_records = iter_eval_lines5cased_text__slice_by_marker_lines_(cased_text, None, None)
    iter_records = _uncompact_(iter_compact_records)
    return iter_records
def _compact_(records, /):
    'records -> compact_records'
    it = records = iter(records)
    for (exp, base, p) in it:
        break
    else:
        raise TypeError('empty file')
    (exp0, base0, _p) = (exp, base, p)
    yield (exp0, base0)
    prev_base = base0
    for (exp, base, p) in it:
        assert exp == exp0
        delta_base = base-prev_base
        half_delta_base = delta_base//2
        assert base == prev_base+2*half_delta_base
        yield half_delta_base
        prev_base = base
def _uncompact_(compact_records, /):
    'compact_records -> records'
    it = compact_records = iter(compact_records)
    def f(exp, base):
        p = 1 + pow(base, exp)
        return (exp, base, p)
    for (exp, base) in it:
        break
    else:
        raise TypeError('empty file')
    yield f(exp, base)
    for half_delta_base in it:
        base += 2*half_delta_base
        yield f(exp, base)


__all__
from script.枚举冫加一偶幂型素数 import 枚举冫加一偶幂型素数扌, 缩水打包冫输出文件扌, 注水解包冫输出文件扌
from script.枚举冫加一偶幂型素数 import *
