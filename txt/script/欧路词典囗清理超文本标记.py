#__all__:goto
r'''[[[
e script/欧路词典囗清理超文本标记.py


script.欧路词典囗清理超文本标记
py -m nn_ns.app.debug_cmd   script.欧路词典囗清理超文本标记 -x
py -m nn_ns.app.doctest_cmd script.欧路词典囗清理超文本标记:__doc__ -v
py -m nn_ns.app.doctest_cmd script.欧路词典囗清理超文本标记!
from script.欧路词典囗清理超文本标记 import *


py_adhoc_call   script.欧路词典囗清理超文本标记   @囗测试囗囗统计出现次数囗超文本标记囗
py_adhoc_call   script.欧路词典囗清理超文本标记   @囗测试囗囗清理囗超文本标记囗
py_adhoc_call   script.欧路词典囗清理超文本标记   @囗测试囗囗初步清理囗超文本标记囗囗欧路词典囗超链接囗
py_adhoc_call   script.欧路词典囗清理超文本标记   @初步清理囗超文本标记囗囗欧路词典囗超链接囗囗文件囗 --encoding:u8   --ipath:/sdcard/0my_files/tmp/out4py/script.字词典囗姓氏提取囗..过滤出候选姓氏囗格式化囗字词典囗..欧路词典.汉语大辞典.词典.out.txt   --may_opath:/sdcard/0my_files/tmp/out4py/script.字词典囗姓氏提取囗..过滤出候选姓氏囗格式化囗字词典囗..欧路词典.汉语大辞典.词典-初步清理.out.txt



py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.计算机词汇.out.词典.txt
======================
2:<br />
======================
{'<br />': 2}



py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.现代汉语词典.out.词典.txt
======================
103271:<br />
32:<corrupted>
2:<方>
1:<方〉驳壳枪。也有叫盒子炮的。
1:<书〉干涸：～辙。
1:<书〉咬。
1:<书〉何不：～往视之？
1:<书〉
1:<书>
======================
{'<br />': 103271, '<corrupted>': 32, '<书〉何不：～往视之？': 1, '<书〉干涸：～辙。': 1, '<方〉驳壳枪。也有叫盒子炮的。': 1, '<书〉咬。': 1, '<方>': 2, '<书>': 1, '<书〉': 1}


py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.中华成语大词典.out.词典.txt
======================
323443:<BR>
98840:</DIV>
98838:<DIV>
49419:<B>
49419:</B>
3681:&nbsp;
21:&gt;
4:<SUP style="FONT-SIZE: 83%; LINE-HEIGHT: normal">
4:</SUP>
4:</SPAN>
2:<DIV style="OVERFLOW-X: hidden; WIDTH: 100%">
2:<DIV style="MARGIN: 5px 0px 0px; WIDTH: 100%">
======================
{'<B>': 49419, '</B>': 49419, '<DIV>': 98838, '<BR>': 323443, '</DIV>': 98840, '&nbsp;': 3681, '&gt;': 21, '</SPAN>': 4, '<SUP style="FONT-SIZE: 83%; LINE-HEIGHT: normal">': 4, '</SUP>': 4, '<DIV style="MARGIN: 5px 0px 0px; WIDTH: 100%">': 2, '<DIV style="OVERFLOW-X: hidden; WIDTH: 100%">': 2}



py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.新世纪英汉科技大词典.out.词典.txt
======================
160342:<br />
======================
{'<br />': 160342}



py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.新世纪汉英科技大词典.out.词典.txt
    [[104行
======================
165161:<br />
3:& output
2:&G.)
2:&F)
2:& staple
2:& deallocation
2:& action analysis
2:& I insurance
2:& C
1:<经>
1:&remote
1:&output
1:&a var.acsphala
1:&Y)
1:&W)
1:&R)
1:&R
1:&O
1:&H)
1:&D)
1:&C)
1:&-down transformer
1:& verify programme
1:& transmitter communication controller
1:& t)
1:& stone carving
1:& spare parts
1:& slotted standard
1:& shen tea
1:& send keyboard set
1:& roll off facilities
1:& restart diagnostic
1:& restart
1:& readout
1:& ramie
1:& pinch on
1:& permit bonds
1:& pepper set
1:& parallel bars
1:& output control
1:& output (PIO)
1:& off shore cable
1:& nuts for steel slotted
1:& noise detection circuit
1:& multiport system
1:& moments
1:& machinery tool grinding machine
1:& loss curve
1:& loader
1:& lantern
1:& lamp holder
1:& lacquer animal
1:& inspection
1:& industrial ceramics
1:& high-frequency capacitor
1:& high voltage power capacitor
1:& grain
1:& forged tool
1:& first-out
1:& fabric
1:& dump system
1:& double action spring hinge
1:& discharge
1:& demultiplexer
1:& delay test set
1:& data bus
1:& coptidis tablets
1:& control system
1:& control panel (MCP)
1:& condemnation
1:& closing rate
1:& c issued ledger
1:& boring machine
1:& blood with hot sauce
1:& bind machine
1:& beating machine
1:& auxiliary vane pump
1:& auto restart
1:& assembling
1:& air partition coefficent
1:& accessory
1:& Whitney
1:& W screen LCD television set
1:& Tobago
1:& T)
1:& REW reel stop detector
1:& REW
1:& Poor's Indices
1:& Poor's Corporation (美国)
1:& O)
1:& O E)
1:& I)
1:& I diagram
1:& I clause
1:& I Club
1:& Fitch
1:& Electric Co. (美国)
1:& Ebi Nor) wind
1:& D. C. arc welding machine
1:& Co., Inc. (美国)
1:& Co.
1:& Cie (BBC) (瑞士)
1:& CC)
1:& 2
======================
    ]]


py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗定位关键位置全过程囗自动化囗.二十一世纪英汉汉英双向词典.out.词典.txt
    [[53行
======================
842006:<br>
738701:</font>
277584:&lt;
277581:&gt;
233248:<font color="#0000FF">
132214:<font color="#FF0000" size=5>
123210:<font color="#04A6B5">
88255:<font color="#FB8C42" face="Kingsoft Phonetic Plain, Tahoma">
44348:<font color="#9933FF">
37233:<font color="#F80AB8">
32364:<font color="#4F86B4">
21279:<font color="#9900CC">
12317:<font color="#330099">
9023:<font color="#F27A04">
4670:&quot;
4499:<hr>
3391:<font color="#006699">
1383:<font color="#046AA4">
466:<font color="#FB8C42">
17:&amp;
2:& magazines
2:& loss
1:<B\棴\ΕA>
1:<>
1:&T (American Telephone
1:& void
1:& unconditional ownership clause
1:& telegraph office
1:& statisticians
1:& statistical statutes
1:& skullcap tablets
1:& removals
1:& pass on.
1:& omission excepted
1:& mushrooms
1:& moxibustion therapy
1:& moxibustion department
1:& margins received
1:& margins paid
1:& magazines subscription counter
1:& magazine allowance;
1:& loss statement
1:& joint pains
1:& green pepper
1:& forsythia tablets
1:& expenditure
1:& death allowance
1:& bean curd
1:& bamboo shoots
1:& Telegraph Company)
1:& Technology
1:& Space Museum
1:& Industrial Research Organisation)
======================
{'<font color="#FF0000" size=5>': 132214, '</font>': 738701, '<br>': 842006, '<font color="#FB8C42" face="Kingsoft Phonetic Plain, Tahoma">': 88255, '<font color="#04A6B5">': 123210, '&lt;': 277584, '&gt;': 277581, '<font color="#0000FF">': 233248, '<font color="#9900CC">': 21279, '<font color="#9933FF">': 44348, '<hr>': 4499, '<font color="#F80AB8">': 37233, '<font color="#4F86B4">': 32364, '&quot;': 4670, '<font color="#F27A04">': 9023, '<font color="#330099">': 12317, '<font color="#006699">': 3391, '<font color="#FB8C42">': 466, '<font color="#046AA4">': 1383, '&amp;': 17, '<\uf8f5B\\棴\\Ε\uf8f5A>': 1, '& Industrial Research Organisation)': 1, '& omission excepted': 1, '& magazines': 2, '& loss': 2, '& margins paid': 1, '& margins received': 1, '& magazines subscription counter': 1, '& green pepper': 1, '& joint pains': 1, '& Technology': 1, '& Space Museum': 1, '& death allowance': 1, '<>': 1, '&T (American Telephone ': 1, '& Telegraph Company)': 1, '& pass on.': 1, '& removals': 1, '& expenditure': 1, '& magazine allowance;': 1, '& mushrooms': 1, '& unconditional ownership clause': 1, '& bean curd': 1, '& bamboo shoots': 1, '& void': 1, '& skullcap tablets': 1, '& forsythia tablets': 1, '& loss statement': 1, '& telegraph office': 1, '& moxibustion department': 1, '& moxibustion therapy': 1, '& statistical statutes': 1, '& statisticians': 1}
    ]]








py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt
    [[
大量类似:
'<A class=ref title="查找: 做甚" href="dic://%E5%81%9A%E7%94%9A">'
'<A class=ref title="查找: 做張做智" href="dic://%E5%81%9A%E5%BC%B5%E5%81%9A%E6%99%BA">'

是 引用/超链接
view /sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt
,阿鼻獄
:<B>阿鼻獄</B><DIV><DIV>(阿鼻獄,阿鼻狱)<BR>見“<A class=ref title="查找: 阿鼻地獄" href="dic://%E9%98%BF%E9%BC%BB%E5%9C%B0%E7%8D%84"><U>阿鼻地獄</U></A>”。</DIV></DIV>
,阿殿
:<B>阿殿</B><DIV><DIV>見“<A class=ref title="查找: 阿房殿" href="dic://%E9%98%BF%E6%88%BF%E6%AE%BF"><U>阿房殿</U></A>”。</DIV></DIV>

    ]]

>>> from urllib.parse import unquote, quote
>>> unquote("dic://%E9%98%BF%E6%88%BF%E6%AE%BF")
'dic://阿房殿'
>>> quote('dic://阿房殿')
'dic%3A//%E9%98%BF%E6%88%BF%E6%AE%BF'

将『<A.../A>』 替换成:『[^{nm}]』之后:
py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt
======================
total:6
----------------------
1388926:<BR>
997819:&nbsp;
696740:<DIV>
696740:</DIV>
348370:<B>
348370:</B>
======================
{'<B>': 348370, '</B>': 348370, '<DIV>': 696740, '<BR>': 1388926, '&nbsp;': 997819, '</DIV>': 696740}



[[
坐板瘡
(坐板瘡,坐板疮)
夏令臀部皮膚所生的一種瘡瘍。初起小顆粒，後則蔓延成片。
 《醫宗金鑒‧外科心法要訣‧坐板瘡》：“坐板瘡在臀腿生，形如黍豆癢焮疼，暑濕熱毒凝肌肉，初宜燙洗油撚烘。”注：“此證一名風疳，生於臀腿之間……由暑令坐日曬几凳，或久坐陰濕之地，以致暑濕熱毒凝滯肌肉而成。”
 沈從文《邊城》十五：“翠翠，莫坐熱石頭，免得生坐板瘡。”
====vs:
,坐板瘡
:<B>坐板瘡</B><DIV><DIV>(坐板瘡,坐板疮)<BR>夏令臀部皮膚所生的一種瘡瘍。初起小顆粒，後則蔓延成片。<BR>&nbsp;《醫宗金鑒‧外科心法要訣‧坐板瘡》：“坐板瘡在臀腿生，形如黍豆癢焮疼，暑濕熱毒凝肌肉，初宜燙洗油撚烘。”注：“此證一名風疳，生於臀腿之間……由暑令坐日曬几凳，或久坐陰濕之地，以致暑濕熱毒凝滯肌肉而成。”<BR>&nbsp;沈從文《邊城》十五：“翠翠，莫坐熱石頭，免得生坐板瘡。”</DIV></DIV>
==>>
<BR>&nbsp; --> <BR> 
'\xA0'==chr(160)==' '

搜:
[^>]&nbsp;
没有找到
]]


将『<A.../A>』 替换成:『[^{nm}]』之后:
replace('<BR>&nbsp;', '<NB>')之后:
py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt
======================
total:6
----------------------
997819:<NB>
696740:<DIV>
696740:</DIV>
391107:<BR>
348370:<B>
348370:</B>
======================
{'<B>': 348370, '</B>': 348370, '<DIV>': 696740, '<NB>': 997819, '<BR>': 391107, '</DIV>': 696740}










将『<A.../A>』 替换成:『[^{nm}]』之后:
replace('<BR>&nbsp;', '<NB>')之后:
py_adhoc_call   script.欧路词典囗清理超文本标记   @囗测试囗囗清理囗超文本标记囗
py_adhoc_call   script.欧路词典囗清理超文本标记   @清理囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt  --opath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典-初步清理.txt

du -bh /sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典.txt
157M
du -bh /sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典-初步清理.txt
145M
view /sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典-初步清理.txt



将『<A.../A>』 替换成:『[^{nm}]』之后:
replace('<BR>&nbsp;', '<NB>')之后:
py_adhoc_call   script.欧路词典囗清理超文本标记   @统计出现次数囗超文本标记囗  --ipath:/sdcard/0my_files/tmp/out4py/script.欧路词典囗.试读囗囗假设简介字节数地址固定囗.汉语大辞典.out.词典-初步清理.txt
======================
total:6
----------------------
997819:<NB>
696740:<DIV>
696740:</DIV>
391107:<BR>
348370:<B>
348370:</B>
======================
{'<B>': 348370, '</B>': 348370, '<DIV>': 696740, '<NB>': 997819, '<BR>': 391107, '</DIV>': 696740}










#]]]'''
__all__ = r'''
    迭代囗多行词条词义囗
    iter_lines_from_ipath
    词条词义囗迭代器
    ProcessEuDic
    tag_pattern
    ref_pattern
    markup_pattern
    regex4markup
    dic_href_pattern
    regex4dic_href

囗超文本标记
    初步清理囗超文本标记囗囗欧路词典囗超链接囗
        囗对象囗初步
        初步清理囗超文本标记囗囗欧路词典囗超链接囗囗文件囗
        囗测试囗囗初步清理囗超文本标记囗囗欧路词典囗超链接囗

    统计出现次数囗超文本标记
        统计出现次数囗超文本标记囗
        囗测试囗囗统计出现次数囗超文本标记囗

    清理囗超文本标记
        清理囗超文本标记囗
        囗测试囗囗清理囗超文本标记囗
囗测试囗

'''.split()#'''
__all__
from seed.tiny import mk_fprint, check_type_is
from seed.io.with4sys_stdinout import with_as_tmp_stdxxx_, with_as_tmp_stdin, with_as_tmp_stdout, with_as_tmp_stderr
from seed.io.may_open import open4w, open4w_err, open4r
#def open4w(may_opath, /, *, force, xencoding):
#def open4r(may_opath, /, *, xencoding):
from itertools import chain, starmap
import re
from collections import Counter
from seed.iters.chains import chains
from seed.tiny import chains
from urllib.parse import unquote, quote


def 迭代囗多行词条词义囗(lines, /):
    '-> (序号, 词条, 词义)'
    i = -1
    for i, word_or_body in enumerate(lines):
        word_or_body = word_or_body.strip()
        if i&1:
            body = word_or_body
            word
            assert body.startswith(':')
            body = body[1:]
            yield (i>>1, word, body)
            del word
        else:
            word = word_or_body
            assert word.startswith(',')
            word = word[1:]
    else:
        i += 1
        if i&1:raise Exception('末尾词义丢失')
def iter_lines_from_ipath(ipath, /, *, force=False, encoding='u8'):
    if not encoding: raise TypeError
    with open4r(ipath, xencoding=encoding) as ifile:
        yield from ifile

class 词条词义囗迭代器:
    def __init__(sf, lines, /):
        sf._it = 迭代囗多行词条词义囗(lines)
    def __iter__(sf, /):
        return sf._it
    @classmethod
    def from_lines(cls, lines, /):
        return cls(lines)
    @classmethod
    def from_ipath(cls, ipath, /, *, force=False, encoding='u8'):
        lines = iter_lines_from_ipath(ipath, force=force, encoding=encoding)
        return cls.from_lines(lines)
class ProcessEuDic:
    def process(sf, /, *, ipath, opath=None, force=False, encoding='u8'):
        if not encoding: raise TypeError
        check_type_is(bool, force)
        with open4r(ipath, xencoding=encoding) as ifile, open4w(opath, force=force, xencoding=encoding) as ofile:
            fprint = mk_fprint(ofile)
            iter_idx_word_body_triples = 迭代囗多行词条词义囗(iter(ifile))
            return sf._process_(fprint, iter_idx_word_body_triples)
    def _process_(sf, fprint, iter_idx_word_body_triples, /):
        pass





tag_pattern = r'(?:<[^<>]*>?|>[^<>]*)'
ref_pattern = r'(?:&[^<>&;]*;?)'
markup_pattern = fr'(?:{tag_pattern}|{ref_pattern})'
regex4markup = re.compile(markup_pattern)

dic_href_pattern = r'<A class=ref title="查找: (?P<nm>[^"]*)" href="dic://(?P<qs>.*)">'
dic_href_pattern = r'“<A class=ref title="查找: (?P<nm>[^"]*)" href="dic://(?P<qs>[^"]*)"><U>(?P<nm2>[^<>]*)</U></A>”'
dic_href_pattern = r'<A class=ref title="查找: (?P<nm>[^"]*)" href="dic://(?P<qs>[^"]*)"><U>(?P<nm2>[^<>]*)</U></A>'
    #remove『“”』
regex4dic_href = re.compile(dic_href_pattern)

class 囗超文本标记(ProcessEuDic):
    def 囗预处理囗词义囗(sf, body, /):
        body = regex4dic_href.sub(sf.囗特殊对待囗转化超文本标记, body)
        body = body.replace('<BR>&nbsp;', '<NB>')
        return body


    def 囗特殊对待囗转化超文本标记(sf, m, /):
        #m = regex4dic_href.fullmatch(mrkp)
        nm = m['nm']
        qs = m['qs']
        nm2 = m['nm2']
        if not (nm==nm2 and nm == unquote(qs) and qs == quote(nm)): raise Exception(m.group(0))
        str4replace = f'[^{nm}]'
        return str4replace
        mrkp = f'&^{nm};'
        return mrkp
囗对象囗初步 = 囗超文本标记()
def 初步清理囗超文本标记囗囗欧路词典囗超链接囗(txt, /):
    return 囗对象囗初步.囗预处理囗词义囗(txt)

def 初步清理囗超文本标记囗囗欧路词典囗超链接囗囗文件囗(*, ipath, may_opath, encoding, force=False):
    if not encoding: raise TypeError
    with open4r(ipath, xencoding=encoding) as ifile, open4w(may_opath, xencoding=encoding, force=force) as ofile:
        #fprint = mk_fprint(ofile)
        for line in ifile:
            line = 初步清理囗超文本标记囗囗欧路词典囗超链接囗(line)
            ofile.write(line)






class 统计出现次数囗超文本标记(囗超文本标记):
    def _process_(sf, fprint, iter_idx_word_body_triples, /):
        c = Counter(chains(starmap(sf.迭代囗超文本标记囗单行词条词义囗, iter_idx_word_body_triples)))
        if 0:
            ps = c.most_common()
            #py.dict不保证稳定！
        else:
            ps = sorted(c.items(), reverse=True,key=lambda kv:kv[::-1])
        ps
        fprint('='*22)
        fprint(f'total:{len(c)}')
        fprint('-'*22)
        for mrkp, cnt in ps:
            fprint(f'{cnt}:{mrkp}')
        fprint('='*22)
        return dict(c)

    def 迭代囗超文本标记囗单行词条词义囗(sf, idx, word, body, /):
        body = sf.囗预处理囗词义囗(body)
        for m in regex4markup.finditer(body):
            if m is None:continue
            yield m.group(0)

统计出现次数囗超文本标记囗 = 统计出现次数囗超文本标记().process


class _G:
    _0_txt4test = r'''
,<aaa>
:aaa<xx1>aaa&xx2;aaa
,&aaa;
:aaa>xx3
,aaa>aaa
:aaa<xx4
,aaa<aaa
:aaa&xx5
,aaa&aaa
:aaa;aaa
,aaa;aaa
:aaa&xx5
'''#'''
    _1_txt4test = r'''
,阿殿
:<B>阿殿</B><DIV><DIV>見“<A class=ref title="查找: 阿房殿" href="dic://%E9%98%BF%E6%88%BF%E6%AE%BF"><U>阿房殿</U></A>”。</DIV></DIV>
,坐不窺堂
:<B>坐不窺堂</B><DIV><DIV>(坐不窺堂,坐不窥堂)<BR>見“<A class=ref title="查找: 坐不闚堂" href="dic://%E5%9D%90%E4%B8%8D%E9%97%9A%E5%A0%82"><U>坐不闚堂</U></A>”。</DIV></DIV>
,坐不窥堂
:<B>坐不窥堂</B><DIV><DIV>(參見<A class=ref title="查找: 坐不窺堂" href="dic://%E5%9D%90%E4%B8%8D%E7%AA%BA%E5%A0%82"><U>坐不窺堂</U></A>,<A class=ref title="查找: 坐不闚堂" href="dic://%E5%9D%90%E4%B8%8D%E9%97%9A%E5%A0%82"><U>坐不闚堂</U></A>)</DIV></DIV>
'''#'''
    _0_free_txt4test = r'''
<BR>&nbsp;<A class=ref title="查找: 阿房殿" href="dic://%E9%98%BF%E6%88%BF%E6%AE%BF"><U>阿房殿</U></A>
'''#'''
def 囗测试囗囗初步清理囗超文本标记囗囗欧路词典囗超链接囗():
    txt = _G._0_free_txt4test
    out = 初步清理囗超文本标记囗囗欧路词典囗超链接囗(txt)
    assert out == r'''
<NB>[^阿房殿]
''', out#'''

    txt = _G._1_txt4test
    out = 初步清理囗超文本标记囗囗欧路词典囗超链接囗(txt)
    assert out == r'''
,阿殿
:<B>阿殿</B><DIV><DIV>見“[^阿房殿]”。</DIV></DIV>
,坐不窺堂
:<B>坐不窺堂</B><DIV><DIV>(坐不窺堂,坐不窥堂)<BR>見“[^坐不闚堂]”。</DIV></DIV>
,坐不窥堂
:<B>坐不窥堂</B><DIV><DIV>(參見[^坐不窺堂],[^坐不闚堂])</DIV></DIV>
''', out#'''
囗测试囗囗初步清理囗超文本标记囗囗欧路词典囗超链接囗()


def 囗测试囗(process, txt, /):
    txt = txt[1:-1]
    with with_as_tmp_stdin(txt) as ifile, with_as_tmp_stdout('') as ofile:
        result = process(ipath=None)
    output = ofile.getvalue()
    return (output, result)
def 囗测试囗囗统计出现次数囗超文本标记囗():
    process = 统计出现次数囗超文本标记囗
    def f(txt, /):
        (output, result) = 囗测试囗(process, txt)
        return output
        return (output, result)
    txt = _G._0_txt4test
    out = f(txt)
    assert out == '======================\ntotal:5\n----------------------\n2:&xx5\n1:>xx3\n1:<xx4\n1:<xx1>\n1:&xx2;\n======================\n', repr(out)
    assert out == '''\
======================
total:5
----------------------
2:&xx5
1:>xx3
1:<xx4
1:<xx1>
1:&xx2;
======================
'''#'''
    txt = _G._1_txt4test
    out = f(txt)
    assert out == '======================\ntotal:5\n----------------------\n6:<DIV>\n6:</DIV>\n3:<B>\n3:</B>\n1:<BR>\n======================\n', repr(out)
    assert out == '''\
======================
total:5
----------------------
6:<DIV>
6:</DIV>
3:<B>
3:</B>
1:<BR>
======================
'''#'''
囗测试囗囗统计出现次数囗超文本标记囗()





class 清理囗超文本标记(囗超文本标记):
    def _process_(sf, fprint, iter_idx_word_body_triples, /):
        xlines = chains(starmap(sf.清理囗超文本标记囗单行词条词义囗, iter_idx_word_body_triples))
        for xline in xlines:
            fprint(xline)
        return

    def 清理囗超文本标记囗单行词条词义囗(sf, idx, word, body, /):
        '-> Iter xline'
        body = sf.囗预处理囗词义囗(body)
        yield ','+word
        yield ':'+body
清理囗超文本标记囗 = 清理囗超文本标记().process


def 囗测试囗囗清理囗超文本标记囗():
    process = 清理囗超文本标记囗
    def f(txt, /):
        (output, result) = 囗测试囗(process, txt)
        return output
        return (output, result)
    txt = _G._0_txt4test
    out = f(txt)
    assert out == txt[1:], repr(out)
    txt = _G._1_txt4test
    out = f(txt)
    assert out == ',阿殿\n:<B>阿殿</B><DIV><DIV>見“[^阿房殿]”。</DIV></DIV>\n,坐不窺堂\n:<B>坐不窺堂</B><DIV><DIV>(坐不窺堂,坐不窥堂)<BR>見“[^坐不闚堂]”。</DIV></DIV>\n,坐不窥堂\n:<B>坐不窥堂</B><DIV><DIV>(參見[^坐不窺堂],[^坐不闚堂])</DIV></DIV>\n', repr(out)
    assert out == '''\
,阿殿
:<B>阿殿</B><DIV><DIV>見“[^阿房殿]”。</DIV></DIV>
,坐不窺堂
:<B>坐不窺堂</B><DIV><DIV>(坐不窺堂,坐不窥堂)<BR>見“[^坐不闚堂]”。</DIV></DIV>
,坐不窥堂
:<B>坐不窥堂</B><DIV><DIV>(參見[^坐不窺堂],[^坐不闚堂])</DIV></DIV>
'''#'''
囗测试囗囗清理囗超文本标记囗()



